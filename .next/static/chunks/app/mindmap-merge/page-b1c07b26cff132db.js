(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[682],{27278:(e,t,r)=>{"use strict";r.d(t,{$:()=>d});var a=r(95155),o=r(12115),s=r(46673),l=r(83101),c=r(2821),n=r(75889);let i=(0,l.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary-500 text-white hover:bg-primary-600",destructive:"bg-red-500 text-white hover:bg-red-600",outline:"border border-gray-300 bg-transparent hover:bg-gray-100 dark:border-gray-600 dark:hover:bg-gray-800",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-100 dark:hover:bg-gray-700",ghost:"hover:bg-gray-100 hover:text-gray-900 dark:hover:bg-gray-800 dark:hover:text-gray-100",link:"text-primary-500 underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=o.forwardRef((e,t)=>{let{className:r,variant:o,size:l,asChild:d=!1,...g}=e,h=d?s.DX:"button";return(0,a.jsx)(h,{className:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.QP)((0,c.$)(t))}(i({variant:o,size:l,className:r})),ref:t,...g})});d.displayName="Button"},51072:(e,t,r)=>{Promise.resolve().then(r.bind(r,79019))},79019:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>S});var a=r(95155),o=r(12115),s=r(71482),l=r(49941),c=r(95535),n=r(33434);r(44669);var i=r(29633),d=r(83457),g=r(91169),h=r(2317),x=r(50906),m=r(1524),p=r(91761),f=r(54255),y=r(89442),u=r(79397),b=r(66955),N=r(95740),j=r(16485),v=r(27278),w=r(78674),k=r(88901),A=r(1087),E=r(12108),C=r(24033);let I=(0,o.memo)(e=>{let{data:t}=e,[r,l]=(0,o.useState)(!1),c=t.icon;return(0,a.jsxs)("div",{className:"rounded-lg ".concat("word"===t.type?"px-3 py-2":"p-3"," cursor-pointer transition-all duration-300 hover:scale-105"),style:(()=>{switch(t.type){case"root":return{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",width:"200px",minHeight:"80px",fontSize:"16px",fontWeight:"bold",boxShadow:"0 10px 30px rgba(102, 126, 234, 0.3)"};case"category":return{background:t.bgColor||"#f3f4f6",color:t.color||"#374151",width:"180px",minHeight:"70px",border:"2px solid ".concat(t.color||"#9ca3af"),boxShadow:"0 4px 15px rgba(0, 0, 0, 0.1)"};case"word":return{background:"".concat(t.bgColor||"#f3f4f6"),color:t.color||"#374151",width:"auto",minWidth:"60px",padding:"6px 12px",fontSize:"".concat(t.size||14,"px"),fontWeight:"500",border:"2px solid ".concat(t.color||"#9ca3af"),boxShadow:"0 0 12px ".concat(t.color||"#9ca3af","40"),cursor:"pointer",opacity:t.opacity||1,transition:"all 0.3s ease"};case"entry":return{background:(e=>e>=4?"linear-gradient(135deg, #d4fc79 0%, #96e6a1 100%)":e>=3?"linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)":e>=2?"linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)":"linear-gradient(135deg, #cfd9df 0%, #e2ebf0 100%)")(t.emotionScore||3),color:"#1f2937",width:"160px",minHeight:"60px",fontSize:"12px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.1)"};default:return{}}})(),onClick:()=>"entry"===t.type&&l(!r),children:[(0,a.jsx)(s.h7,{type:"target",position:s.yX.Top,style:{background:"#555",width:8,height:8}}),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[c&&"category"===t.type&&(0,a.jsx)(c,{className:"w-6 h-6 mb-2",style:{color:t.color}}),"root"===t.type&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(N.A,{className:"w-8 h-8 mb-2"}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{children:t.label}),t.count&&(0,a.jsxs)("div",{className:"text-sm opacity-90 mt-1",children:[t.count,"件の日記"]})]})]}),"category"===t.type&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"font-semibold",children:t.label}),t.count&&(0,a.jsxs)("div",{className:"text-sm mt-1 opacity-80",children:[t.count,"件"]}),t.entries&&t.entries.length>5&&(0,a.jsxs)("div",{className:"text-xs mt-1 opacity-60",children:["他",t.entries.length-5,"件..."]})]}),"entry"===t.type&&(0,a.jsxs)(a.Fragment,{children:[t.date&&(0,a.jsxs)("div",{className:"flex items-center gap-1 text-xs opacity-70 mb-1",children:[(0,a.jsx)(j.A,{className:"w-3 h-3"}),t.date]}),(0,a.jsx)("div",{className:"text-center ".concat(r?"":"line-clamp-2"),children:t.label}),t.fullContent&&(0,a.jsx)("div",{className:"flex justify-center mt-1",children:r?(0,a.jsx)(E.A,{className:"w-4 h-4 opacity-50"}):(0,a.jsx)(C.A,{className:"w-4 h-4 opacity-50"})}),r&&t.fullContent&&(0,a.jsx)("div",{className:"text-xs mt-2 p-2 bg-white/50 dark:bg-black/20 rounded max-h-32 overflow-y-auto",children:t.fullContent})]}),"word"===t.type&&(0,a.jsx)("div",{className:"text-center font-medium",children:t.label})]}),(0,a.jsx)(s.h7,{type:"source",position:s.yX.Bottom,style:{background:"#555",width:8,height:8}})]})});I.displayName="MergedDiaryNode";let O={WORK:"仕事",FAMILY:"家族",FRIENDS:"友達",HOBBY:"趣味",HEALTH:"健康",RELATIONSHIP:"人間関係",GROWTH:"成長",FINANCE:"金銭",TRAVEL:"旅行",EDUCATION:"学習"},H={[O.WORK]:{icon:i.A,color:"#3b82f6",bgColor:"#dbeafe"},[O.FAMILY]:{icon:d.A,color:"#ef4444",bgColor:"#fee2e2"},[O.FRIENDS]:{icon:g.A,color:"#10b981",bgColor:"#d1fae5"},[O.HOBBY]:{icon:h.A,color:"#8b5cf6",bgColor:"#ede9fe"},[O.HEALTH]:{icon:x.A,color:"#22c55e",bgColor:"#dcfce7"},[O.RELATIONSHIP]:{icon:d.A,color:"#f59e0b",bgColor:"#fed7aa"},[O.GROWTH]:{icon:m.A,color:"#06b6d4",bgColor:"#cffafe"},[O.FINANCE]:{icon:p.A,color:"#84cc16",bgColor:"#ecfccb"},[O.TRAVEL]:{icon:f.A,color:"#ec4899",bgColor:"#fce7f3"},[O.EDUCATION]:{icon:y.A,color:"#6366f1",bgColor:"#e0e7ff"}},R={merged:I};function T(){let[e,t,r]=(0,s.ck)([]),[i,d,g]=(0,s.fM)([]),[h,x]=(0,o.useState)([]),[m,p]=(0,o.useState)("month"),[f,y]=(0,o.useState)(!1),[E,C]=(0,o.useState)(null);(0,o.useEffect)(()=>{I()},[]),(0,o.useEffect)(()=>{h.length>0&&S()},[h,m]);let I=async()=>{try{let e=await fetch("/api/diary");if(e.ok){let t=await e.json();x(t)}}catch(e){console.error("日記データの取得に失敗:",e)}},T=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,a={[O.WORK]:[/会議|ミーティング|打ち合わせ/g,/プロジェクト|案件|タスク/g,/残業|締切|納期/g,/上司|部長|同僚|チーム/g,/資料|レポート|報告書/g,/メール|電話|連絡/g],[O.FAMILY]:[/[息娘]子|子供|赤ちゃん/g,/[夫妻]|パパ|ママ/g,/[父母]親|祖[父母]/g,/家族|実家|帰省/g,/誕生日|記念日/g],[O.FRIENDS]:[/友[達人]|仲間/g,/飲み会|パーティー|集まり/g,/遊び|カラオケ/g,/LINE|連絡|電話/g],[O.HOBBY]:[/映画|ドラマ|アニメ/g,/音楽|ライブ|コンサート/g,/ゲーム|PS|Switch/g,/読書|小説|漫画|本/g,/料理|レシピ|お菓子/g],[O.HEALTH]:[/運動|ジム|筋トレ|ランニング/g,/体調|風邪|熱|頭痛/g,/病院|診察|薬/g,/睡眠|疲れ|ストレス/g,/ダイエット|体重/g],[O.RELATIONSHIP]:[/彼[氏女]|恋人|パートナー/g,/デート|約束/g,/愛|好き|大切/g,/結婚|将来|夢/g],[O.GROWTH]:[/目標|計画|達成/g,/勉強|学習|資格/g,/成長|向上|改善/g,/挑戦|チャレンジ/g],[O.FINANCE]:[/給料|ボーナス|収入/g,/貯金|節約|お金/g,/買い物|購入|支払/g,/家計|生活費/g],[O.TRAVEL]:[/旅行|観光|ツアー/g,/ホテル|宿泊/g,/飛行機|新幹線|電車/g,/[温泉]|観光地/g],[O.EDUCATION]:[/授業|講義|セミナー/g,/宿題|課題|レポート/g,/試験|テスト|受験/g,/先生|教授|講師/g]}[t]||[],o=new Set;a.forEach(t=>{let r=e.match(t);r&&r.forEach(e=>{e&&e.length>=2&&e.length<=10&&o.add(e)})});let s=e.match(/\d+[時間日分キロメートル円万]/g);s&&t===O.WORK&&s.slice(0,2).forEach(e=>o.add(e));let l=e.match(/[月火水木金土日]曜日/g);return(l&&(t===O.WORK||t===O.FRIENDS)&&l.slice(0,2).forEach(e=>o.add(e)),0===o.size)?({[O.WORK]:["仕事","業務","タスク","会社"],[O.FAMILY]:["家族","家庭","子供","両親"],[O.FRIENDS]:["友達","仲間","友人","交流"],[O.HOBBY]:["趣味","楽しみ","遊び","リラックス"],[O.HEALTH]:["健康","体調","運動","休息"],[O.RELATIONSHIP]:["関係","恋愛","パートナー","感情"],[O.GROWTH]:["成長","目標","学習","挑戦"],[O.FINANCE]:["お金","貯金","収支","経済"],[O.TRAVEL]:["旅","移動","観光","発見"],[O.EDUCATION]:["学習","知識","勉強","教育"]})[t]||[]:Array.from(o).slice(0,r)},S=async()=>{y(!0);try{let e=[...h],r=new Date;switch(m){case"month":let a=(0,w.w)(r),o=(0,k.p)(r);e=h.filter(e=>{let t=new Date(e.entryDate);return t>=a&&t<=o});break;case"3months":let l=(0,A.a)(r,3);e=h.filter(e=>new Date(e.entryDate)>=l);break;case"year":let c=(0,A.a)(r,12);e=h.filter(e=>new Date(e.entryDate)>=c)}let n=new Map,i=new Map;e.forEach(e=>{(e=>{let t=[];return Object.entries({[O.WORK]:["仕事","メール","会議","業務","会社","プロジェクト","残業","職場"],[O.FAMILY]:["家族","子供","親","母","父","兄","弟","姉","妹","夫","妻"],[O.FRIENDS]:["友達","友人","仲間","同僚","先輩","後輩"],[O.HOBBY]:["趣味","映画","読書","小説","ゲーム","音楽","スポーツ","料理"],[O.HEALTH]:["健康","病気","熱","風邪","運動","散歩","ジム","薬","病院"],[O.RELATIONSHIP]:["恋愛","彼氏","彼女","デート","結婚","離婚"],[O.GROWTH]:["成長","学習","勉強","挑戦","目標","達成","成功","失敗"],[O.FINANCE]:["お金","給料","貯金","投資","買い物","節約"],[O.TRAVEL]:["旅行","旅","観光","海外","国内","ホテル","飛行機"],[O.EDUCATION]:["勉強","学習","資格","試験","授業","講座","セミナー"]}).forEach(r=>{let[a,o]=r;o.some(t=>e.includes(t))&&t.push(a)}),0===t.length&&t.push(O.GROWTH),t})(e.content||"").forEach(t=>{n.has(t)||n.set(t,[]),n.get(t).push(e)})}),n.forEach((e,t)=>{let r=e.map(e=>e.content||"").join(" "),a=T(r,t,8);i.set(t,a)}),C({categories:n,totalEntries:e.length,period:m});let g=[],x=[],p={id:"root",type:"merged",position:{x:0,y:0},data:{label:L(m),type:"root",count:e.length,emotionScore:3}};g.push(p);let f=2*Math.PI/n.size,y=0;Array.from(n.entries()).forEach(e=>{let[t,r]=e,a=y*f,o=300*Math.cos(a),l=300*Math.sin(a),c=H[t],n="category-".concat(t);g.push({id:n,type:"merged",position:{x:o,y:l},data:{label:t,type:"category",icon:c.icon,color:c.color,bgColor:c.bgColor,count:r.length,entries:r}}),x.push({id:"edge-root-".concat(n),source:"root",target:n,type:"smoothstep",animated:r.length>3,markerEnd:{type:s.TG.ArrowClosed,width:20,height:20,color:c.color},style:{stroke:c.color,strokeWidth:Math.min(.8*r.length,4),strokeOpacity:.8}});let d=i.get(t)||[],h=2*Math.PI/Math.max(d.length,1);d.forEach((e,r)=>{let a=r*h,i=150+(80*Math.random()-40),d=o+i*Math.cos(a),m=l+i*Math.sin(a),p="word-".concat(t,"-").concat(r),f=.8+.2*Math.random(),y=10*Math.random()+14;g.push({id:p,type:"merged",position:{x:d,y:m},data:{label:e,type:"word",category:t,color:c.color,bgColor:c.bgColor,size:y,opacity:f}}),x.push({id:"edge-".concat(n,"-").concat(p),source:n,target:p,type:"straight",animated:!0,markerEnd:{type:s.TG.ArrowClosed,width:10,height:10,color:c.color},style:{stroke:c.color,strokeWidth:1.5,strokeOpacity:.6,strokeDasharray:"3,3"}})}),y++}),t(g),d(x)}catch(e){console.error("マインドマップ生成エラー:",e)}finally{y(!1)}},L=e=>{switch(e){case"month":return"今月の人生マップ";case"3months":return"過去3ヶ月の人生マップ";case"year":return"今年の人生マップ";case"all":return"人生の全体マップ";default:return"人生マップ"}};return(0,a.jsxs)("div",{className:"h-screen flex flex-col bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50 dark:from-gray-900 dark:via-purple-900/20 dark:to-gray-900",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow-sm px-6 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[(0,a.jsx)(u.A,{className:"w-6 h-6 text-purple-500"}),"統合マインドマップ"]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"日記をカテゴリー別に分類して人生の全体像を可視化"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(b.A,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"}),(0,a.jsxs)("select",{value:m,onChange:e=>p(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,a.jsx)("option",{value:"month",children:"今月"}),(0,a.jsx)("option",{value:"3months",children:"過去3ヶ月"}),(0,a.jsx)("option",{value:"year",children:"過去1年"}),(0,a.jsx)("option",{value:"all",children:"全期間"})]})]}),(0,a.jsxs)(v.$,{onClick:S,disabled:f,className:"gap-2",children:[(0,a.jsx)(N.A,{className:"w-4 h-4"}),f?"分析中...":"再生成"]})]})]}),E&&(0,a.jsxs)("div",{className:"mt-4 flex gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(j.A,{className:"w-4 h-4 text-gray-500"}),(0,a.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:[E.totalEntries,"件の日記"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.A,{className:"w-4 h-4 text-gray-500"}),(0,a.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:[E.categories.size,"個のカテゴリー"]})]})]})]}),(0,a.jsx)("div",{className:"flex-1",children:f?(0,a.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"日記を分析してカテゴリーに分類中..."})]})}):(0,a.jsxs)(s.Gc,{nodes:e,edges:i,onNodesChange:r,onEdgesChange:g,nodeTypes:R,connectionMode:s.WZ.Loose,fitView:!0,className:"bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50 dark:from-gray-900 dark:via-purple-900/20 dark:to-gray-900",children:[(0,a.jsx)(l.V,{}),(0,a.jsx)(c.H,{}),(0,a.jsx)(n.o,{})]})}),(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 px-6 py-3 border-t",children:(0,a.jsxs)("div",{className:"flex gap-4 items-center flex-wrap",children:[(0,a.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"カテゴリー:"}),Object.entries(H).map(e=>{let[t,r]=e,o=r.icon;return(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(o,{className:"w-3 h-3",style:{color:r.color}}),(0,a.jsx)("span",{className:"text-xs",style:{color:r.color},children:t})]},t)})]})})]})}function S(){return(0,a.jsx)(s.Ln,{children:(0,a.jsx)(T,{})})}}},e=>{e.O(0,[718,702,407,143,198,465,53,441,255,977],()=>e(e.s=51072)),_N_E=e.O()}]);