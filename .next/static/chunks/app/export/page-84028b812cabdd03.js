(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[393],{9625:(e,a,t)=>{Promise.resolve().then(t.bind(t,85882))},16485:(e,a,t)=>{"use strict";t.d(a,{A:()=>r});let r=(0,t(71847).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},27278:(e,a,t)=>{"use strict";t.d(a,{$:()=>o});var r=t(95155),s=t(12115),n=t(46673),l=t(83101),d=t(2821),i=t(75889);let c=(0,l.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary-500 text-white hover:bg-primary-600",destructive:"bg-red-500 text-white hover:bg-red-600",outline:"border border-gray-300 bg-transparent hover:bg-gray-100 dark:border-gray-600 dark:hover:bg-gray-800",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-100 dark:hover:bg-gray-700",ghost:"hover:bg-gray-100 hover:text-gray-900 dark:hover:bg-gray-800 dark:hover:text-gray-100",link:"text-primary-500 underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=s.forwardRef((e,a)=>{let{className:t,variant:s,size:l,asChild:o=!1,...h}=e,g=o?n.DX:"button";return(0,r.jsx)(g,{className:function(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,i.QP)((0,d.$)(a))}(c({variant:s,size:l,className:t})),ref:a,...h})});o.displayName="Button"},39867:(e,a,t)=>{"use strict";t.d(a,{A:()=>r});let r=(0,t(71847).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},42529:(e,a,t)=>{"use strict";t.d(a,{A:()=>r});let r=(0,t(71847).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},85882:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>m});var r=t(95155),s=t(12115),n=t(71847);let l=(0,n.A)("file-json",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]),d=(0,n.A)("file-spreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]),i=(0,n.A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var c=t(42529),o=t(39867),h=t(16485),g=t(27278),x=t(77007),y=t(55041);function m(){let[e,a]=(0,s.useState)([]),[t,n]=(0,s.useState)("json"),[m,u]=(0,s.useState)("all"),[p,b]=(0,s.useState)(""),[k,v]=(0,s.useState)(""),[f,j]=(0,s.useState)(!1),[w,N]=(0,s.useState)(!1),M=[{id:"json",name:"JSON形式",description:"完全なデータ構造を保持（バックアップ用）",icon:l,extension:"json"},{id:"csv",name:"CSV形式",description:"Excel等で開ける表形式",icon:d,extension:"csv"},{id:"txt",name:"テキスト形式",description:"シンプルなテキストファイル",icon:i,extension:"txt"}];(0,s.useEffect)(()=>{D()},[]);let D=async()=>{try{let e=await fetch("/api/diary");if(e.ok){let t=await e.json();a(t)}}catch(e){console.error("日記データの取得に失敗:",e)}},A=async()=>{j(!0),N(!1);let a=(e=>{let a=new Date,t=[...e];switch(m){case"month":let r=new Date(a.getFullYear(),a.getMonth()-1,a.getDate());t=e.filter(e=>new Date(e.entryDate)>=r);break;case"year":let s=new Date(a.getFullYear()-1,a.getMonth(),a.getDate());t=e.filter(e=>new Date(e.entryDate)>=s);break;case"custom":p&&k&&(t=e.filter(e=>{let a=new Date(e.entryDate);return a>=new Date(p)&&a<=new Date(k)}))}return t})(e);try{var r;let e="",s="diary_export_".concat((0,x.GP)(new Date,"yyyyMMdd")),n="";switch(t){case"json":e=JSON.stringify(a,null,2),n="application/json";break;case"csv":e="日付,内容\n",a.forEach(a=>{let t=(0,x.GP)(new Date(a.entryDate),"yyyy-MM-dd",{locale:y.ja}),r='"'.concat((a.content||"").replace(/"/g,'""'),'"');e+="".concat(t,",").concat(r,"\n")}),n="text/csv;charset=utf-8";break;case"txt":a.forEach((a,t)=>{let r=(0,x.GP)(new Date(a.entryDate),"yyyy年MM月dd日",{locale:y.ja});e+="".concat("=".repeat(50),"\n"),e+="【".concat(t+1,"】 ").concat(r,"\n"),e+="".concat("=".repeat(50),"\n\n"),e+=a.content+"\n\n",a.tags&&a.tags.length>0&&(e+="タグ: ".concat(a.tags.join(", "),"\n\n"))}),n="text/plain;charset=utf-8"}let l=new Uint8Array([239,187,191]),d=new Blob([l,e],{type:n}),i=URL.createObjectURL(d),c=document.createElement("a");c.href=i,c.download="".concat(s,".").concat(null==(r=M.find(e=>e.id===t))?void 0:r.extension),document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(i),N(!0),setTimeout(()=>N(!1),3e3)}catch(e){console.error("エクスポート処理でエラーが発生:",e)}finally{j(!1)}};return(0,r.jsxs)("div",{className:"max-w-4xl mx-auto py-8 px-4",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"日記データのエクスポート"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"日記データをバックアップ用にダウンロードできます"}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 mb-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"エクスポート形式"}),(0,r.jsx)("div",{className:"grid gap-4",children:M.map(e=>(0,r.jsxs)("label",{className:"flex items-start gap-4 p-4 border rounded-lg cursor-pointer transition-all ".concat(t===e.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300"),children:[(0,r.jsx)("input",{type:"radio",name:"format",value:e.id,checked:t===e.id,onChange:e=>n(e.target.value),className:"mt-1"}),(0,r.jsx)(e.icon,{className:"w-5 h-5 text-gray-600 dark:text-gray-400 mt-0.5"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),(0,r.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]})]},e.id))})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 mb-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"エクスポート期間"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("label",{className:"flex items-center gap-3",children:[(0,r.jsx)("input",{type:"radio",name:"dateRange",value:"all",checked:"all"===m,onChange:e=>u(e.target.value)}),(0,r.jsx)("span",{className:"text-gray-900 dark:text-white",children:"すべての日記"}),(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:["（",e.length,"件）"]})]}),(0,r.jsxs)("label",{className:"flex items-center gap-3",children:[(0,r.jsx)("input",{type:"radio",name:"dateRange",value:"month",checked:"month"===m,onChange:e=>u(e.target.value)}),(0,r.jsx)("span",{className:"text-gray-900 dark:text-white",children:"過去1ヶ月"})]}),(0,r.jsxs)("label",{className:"flex items-center gap-3",children:[(0,r.jsx)("input",{type:"radio",name:"dateRange",value:"year",checked:"year"===m,onChange:e=>u(e.target.value)}),(0,r.jsx)("span",{className:"text-gray-900 dark:text-white",children:"過去1年"})]}),(0,r.jsxs)("label",{className:"flex items-center gap-3",children:[(0,r.jsx)("input",{type:"radio",name:"dateRange",value:"custom",checked:"custom"===m,onChange:e=>u(e.target.value)}),(0,r.jsx)("span",{className:"text-gray-900 dark:text-white",children:"期間を指定"})]}),"custom"===m&&(0,r.jsxs)("div",{className:"ml-6 mt-3 flex gap-3 items-center",children:[(0,r.jsx)("input",{type:"date",value:p,onChange:e=>b(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),(0,r.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"〜"}),(0,r.jsx)("input",{type:"date",value:k,onChange:e=>v(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]})]}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(g.$,{onClick:A,disabled:f||0===e.length,className:"gap-2",size:"lg",children:f?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"エクスポート中..."]}):w?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.A,{className:"w-5 h-5"}),"ダウンロード完了！"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.A,{className:"w-5 h-5"}),"エクスポート"]})})}),(0,r.jsxs)("div",{className:"mt-8 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[(0,r.jsxs)("h3",{className:"font-medium text-blue-900 dark:text-blue-300 mb-2",children:[(0,r.jsx)(h.A,{className:"inline w-4 h-4 mr-2"}),"エクスポートデータについて"]}),(0,r.jsxs)("ul",{className:"text-sm text-blue-800 dark:text-blue-400 space-y-1",children:[(0,r.jsx)("li",{children:"• エクスポートされたデータは個人情報を含みます。取り扱いにご注意ください"}),(0,r.jsx)("li",{children:"• JSONファイルは再インポート可能な形式です"}),(0,r.jsx)("li",{children:"• CSVファイルはExcelやGoogleスプレッドシートで開けます"}),(0,r.jsx)("li",{children:"• テキストファイルは読みやすい形式で出力されます"})]})]})]})}}},e=>{e.O(0,[407,112,441,255,977],()=>e(e.s=9625)),_N_E=e.O()}]);