(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[530],{18085:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},20508:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},27278:(e,t,r)=>{"use strict";r.d(t,{$:()=>c});var a=r(95155),s=r(12115),l=r(46673),i=r(83101),n=r(2821),d=r(75889);let o=(0,i.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary-500 text-white hover:bg-primary-600",destructive:"bg-red-500 text-white hover:bg-red-600",outline:"border border-gray-300 bg-transparent hover:bg-gray-100 dark:border-gray-600 dark:hover:bg-gray-800",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-100 dark:hover:bg-gray-700",ghost:"hover:bg-gray-100 hover:text-gray-900 dark:hover:bg-gray-800 dark:hover:text-gray-100",link:"text-primary-500 underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,t)=>{let{className:r,variant:s,size:i,asChild:c=!1,...h}=e,g=c?l.DX:"button";return(0,a.jsx)(g,{className:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,d.QP)((0,n.$)(t))}(o({variant:s,size:i,className:r})),ref:t,...h})});c.displayName="Button"},28466:(e,t,r)=>{Promise.resolve().then(r.bind(r,54801))},35299:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},54801:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var a=r(95155),s=r(12115);let l=(0,r(71847).A)("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);var i=r(20508),n=r(35299),d=r(18085),o=r(27278),c=r(77007),h=r(55041);function g(){let[e,t]=(0,s.useState)([]),[r,g]=(0,s.useState)(""),[x,u]=(0,s.useState)(!1),[m,y]=(0,s.useState)(0),f=(0,s.useRef)(null);(0,s.useEffect)(()=>{p()},[]);let p=async()=>{try{let e=await fetch("/api/diary");if(e.ok){let r=await e.json();y(r.length),t([{id:"1",role:"assistant",content:"毎日お疲れ様。何か質問ある？",timestamp:new Date}])}}catch(e){console.error("日記統計の取得に失敗:",e)}},b=async a=>{if(a.preventDefault(),!r.trim()||x)return;let s={id:Date.now().toString(),role:"user",content:r.trim(),timestamp:new Date};t(e=>[...e,s]),g(""),u(!0);try{let a=await fetch("/api/ai/consultation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:r.trim(),history:e})});if(a.ok){let e=await a.json(),r={id:(Date.now()+1).toString(),role:"assistant",content:e.response||"すみません、お返事を生成できませんでした。",timestamp:new Date};t(e=>[...e,r])}}catch(r){console.error("メッセージ送信エラー:",r);let e={id:(Date.now()+1).toString(),role:"assistant",content:"エラーが発生しました。もう一度お試しください。",timestamp:new Date};t(t=>[...t,e])}finally{u(!1)}};return(0,s.useEffect)(()=>{var e;null==(e=f.current)||e.scrollIntoView({behavior:"smooth"})},[e]),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto h-[calc(100vh-120px)] flex flex-col",children:[(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-t-lg shadow-sm p-4 border-b",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:(0,a.jsx)(l,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"AI相談モード"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[m,"件の日記を学習済み"]})]})]})})}),(0,a.jsxs)("div",{className:"flex-1 bg-gray-50 dark:bg-gray-900 overflow-y-auto p-4 space-y-4",children:[e.map(e=>(0,a.jsxs)("div",{className:"flex gap-3 ".concat("user"===e.role?"flex-row-reverse":""),children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ".concat("user"===e.role?"bg-gradient-to-br from-green-500 to-emerald-600":"bg-gradient-to-br from-blue-500 to-purple-600"),children:"user"===e.role?(0,a.jsx)(i.A,{className:"w-4 h-4 text-white"}):(0,a.jsx)(l,{className:"w-4 h-4 text-white"})}),(0,a.jsxs)("div",{className:"max-w-[70%] rounded-2xl p-4 ".concat("user"===e.role?"bg-blue-500 text-white":"bg-white dark:bg-gray-800 text-gray-900 dark:text-white"),children:[(0,a.jsx)("div",{className:"whitespace-pre-wrap",children:e.content}),(0,a.jsx)("div",{className:"text-xs mt-2 ".concat("user"===e.role?"text-blue-100":"text-gray-500 dark:text-gray-400"),children:(0,c.GP)(e.timestamp,"HH:mm",{locale:h.ja})})]})]},e.id)),x&&(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:(0,a.jsx)(l,{className:"w-4 h-4 text-white"})}),(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n.A,{className:"w-4 h-4 animate-spin text-gray-500"}),(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"考え中..."})]})})]}),(0,a.jsx)("div",{ref:f})]}),(0,a.jsxs)("form",{onSubmit:b,className:"bg-white dark:bg-gray-800 rounded-b-lg shadow-sm p-4 border-t",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:r,onChange:e=>g(e.target.value),placeholder:"メッセージを入力...",className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-full bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:x}),(0,a.jsx)(o.$,{type:"submit",size:"icon",className:"rounded-full",disabled:!r.trim()||x,children:(0,a.jsx)(d.A,{className:"w-4 h-4"})})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 text-center",children:"過去の日記を基にAIがパーソナライズされた回答を提供します"})]})]})}}},e=>{e.O(0,[407,112,441,255,977],()=>e(e.s=28466)),_N_E=e.O()}]);