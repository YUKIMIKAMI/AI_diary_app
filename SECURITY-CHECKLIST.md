# 🔒 セキュリティチェックリスト

## デプロイ前の最終確認

### 1. APIキー関連
- [ ] `.env`ファイルに本番APIキーが入っていない
- [ ] コード内にAPIキーのハードコーディングがない
- [ ] Vercelの環境変数にAPIキーを設定していない

### 2. Git関連
- [ ] `.gitignore`に`.env`が含まれている
- [ ] `git status`で`.env`が表示されていない
- [ ] 過去のコミットにAPIキーが含まれていない

### 3. データ保護
- [ ] デモモードでは個人情報を保存しない
- [ ] セッションストレージ/ローカルストレージのクリア機能
- [ ] CORS設定が適切

### 4. レート制限
- [ ] デモモードでレート制限が有効
- [ ] 1時間あたり100リクエスト制限
- [ ] IPアドレスベースの制限

### 5. エラーハンドリング
- [ ] エラーメッセージに機密情報が含まれない
- [ ] スタックトレースが本番環境で表示されない
- [ ] 404/500エラーページが存在

## 公開時の追加対策

### 必須対応
```bash
# 1. 環境変数の確認
echo %OPENAI_API_KEY%  # 空であることを確認

# 2. デモビルドの実行
npm run build:demo

# 3. ローカルでデモモード確認
npm run dev:demo
```

### Vercelデプロイ時
1. 環境変数は設定しない
2. `NEXT_PUBLIC_DEMO_MODE=true`のみ設定（任意）
3. ドメインアクセス制限を検討

### 監視
- Vercelのダッシュボードで以下を監視：
  - リクエスト数
  - エラーレート
  - 帯域使用量

## 緊急時の対応

### APIキーが漏洩した場合
1. **即座にAPIキーを無効化**
   - OpenAI: https://platform.openai.com/api-keys
   - Google: https://console.cloud.google.com/

2. **新しいキーを生成**

3. **使用状況を確認**
   - 不正な課金がないか確認
   - サポートに連絡

### サイトが攻撃された場合
1. **Vercelで一時停止**
   - ダッシュボードから「Pause Deployment」

2. **ログを確認**
   - 攻撃元のIPアドレス特定
   - Vercelのファイアウォール設定

## 推奨事項

### DO ✅
- デモモードで公開
- 定期的な監視
- バックアップの保持
- セキュリティアップデートの適用

### DON'T ❌
- 本番APIキーの使用
- 個人情報の保存
- CORSの無効化
- エラーの詳細表示

## 最終チェック

```bash
# セキュリティスキャン（オプション）
npm audit

# 依存関係の更新
npm update

# ビルドエラーの確認
npm run build:demo
```

---

このチェックリストを確認してから公開してください！