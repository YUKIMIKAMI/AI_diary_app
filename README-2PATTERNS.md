# 🎯 2パターン環境の使い方

## 📦 環境構成

このアプリは**2つのモード**で動作します：

| モード | APIキー | データ保存 | 用途 | コマンド |
|--------|---------|-----------|------|---------|
| **開発モード** | 必要 | あり | ローカル開発・デモ動画撮影 | `npm run dev:full` |
| **デモモード** | 不要 | なし | 公開・ハッカソン提出 | `npm run dev:demo` |

---

## 🚀 クイックスタート

### 1️⃣ ローカル開発（フル機能）

```bash
# .envファイルにAPIキーを設定
OPENAI_API_KEY=sk-xxxx
GOOGLE_API_KEY=AIxxxx

# 開発モードで起動
npm run dev:full

# または
npm run test:local
```

**特徴:**
- ✅ 実際のAI API使用
- ✅ リアルタイム応答
- ✅ データベース保存
- ✅ 全機能利用可能
- ⚠️ API課金発生

### 2️⃣ デモ環境（安全公開）

```bash
# APIキーなしで起動
npm run dev:demo

# または
npm run test:demo
```

**特徴:**
- ✅ APIキー不要
- ✅ 課金リスクなし
- ✅ 高速レスポンス
- ✅ 安全に公開可能
- ⚠️ 固定応答（でも賢く見える）

---

## 🌐 デプロイ方法

### Vercelへのデモ版デプロイ

```bash
# 1. Vercel CLIインストール（初回のみ）
npm i -g vercel

# 2. デモビルド & デプロイ
npm run deploy:demo

# 3. 表示されるURLにアクセス
# https://your-app.vercel.app
```

**重要:** Vercelの環境変数は設定しないでください！

---

## 🔄 モード自動判定

アプリは以下の優先順位で自動判定します：

1. **本番環境（Vercel等）** → デモモード
2. **APIキーあり** → 開発モード
3. **その他** → デモモード

```typescript
// src/lib/config.ts で自動判定
if (process.env.VERCEL) return 'demo'
if (process.env.OPENAI_API_KEY) return 'development'
return 'demo'
```

---

## 🎭 デモモードの賢い応答

デモモードでも、キーワードに応じて適切な応答を返します：

| ユーザー入力 | AI応答例 |
|-------------|---------|
| 「疲れた」 | 「お疲れ様でした。ゆっくり休むことも大切ですね。」 |
| 「嬉しい」 | 「素晴らしいですね！その喜びを詳しく聞かせてください。」 |
| 「悩み」 | 「それは難しい状況ですね。一緒に整理してみましょう。」 |

---

## 📊 モード確認方法

### ブラウザで確認

1. **開発モード**: 画面左上に緑色の「開発モード: API使用中」バッジ
2. **デモモード**: 画面右下に紫色の「デモモードで動作中」通知

### コンソールで確認

```javascript
// ブラウザの開発者ツール
console.log(config.mode)  // 'development' or 'demo'
```

---

## 🔧 トラブルシューティング

### Q: デモモードなのにAPIエラーが出る
A: `.env`ファイルを確認し、誤ったAPIキーが設定されていないか確認

### Q: 開発モードで動かない
A: APIキーが正しく設定されているか確認
```bash
echo %OPENAI_API_KEY%  # Windows
echo $OPENAI_API_KEY   # Mac/Linux
```

### Q: Vercelデプロイ後、サイトが動かない
A: ビルドログを確認し、`npm run build:demo`が成功しているか確認

---

## 📝 ハッカソン提出時の注意

1. **デモURL**: デモモードでデプロイしたURLを提出
2. **動画撮影**: ローカル開発モードで撮影（リアルAI応答）
3. **説明**: 「セキュリティのためデモモードで公開」と明記

---

## 🎯 使い分けの推奨

| シーン | 推奨モード | 理由 |
|--------|-----------|------|
| 開発作業 | 開発モード | 実際の動作確認 |
| デモ動画撮影 | 開発モード | リアルな応答 |
| ハッカソン提出 | デモモード | 安全性 |
| 審査員アクセス | デモモード | 課金防止 |
| 友人に見せる | デモモード | API保護 |

---

## ✅ チェックリスト

### デプロイ前の確認

- [ ] `.env`ファイルは`.gitignore`に含まれているか
- [ ] APIキーがコードに直書きされていないか
- [ ] デモモードで基本機能が動作するか
- [ ] エラーが出ないか
- [ ] レスポンスが高速か

### 提出前の確認

- [ ] デモURLが動作するか
- [ ] 複数ブラウザで確認したか
- [ ] モバイル表示も確認したか
- [ ] 初見の人でも使えるか

---

## 🚀 コマンド一覧

```bash
# 開発
npm run dev:full    # 開発モード（API使用）
npm run dev:demo    # デモモード（API不使用）

# ビルド
npm run build       # 通常ビルド
npm run build:demo  # デモ用ビルド

# デプロイ
npm run deploy:demo # Vercelへデモ版デプロイ

# テスト
npm run test:local  # ローカル環境テスト
npm run test:demo   # デモ環境テスト
```

---

これで安心して開発と公開ができます！ 🎉